<!-- Latest compiled and minified CSS -->
<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
/>
<style>
  * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
  }

  body {
      background: #c4c4c4;
      font-family: 'Font1', sans-serif;
      margin:0;
  }

  .container {
      width: 100%;
      max-width: 64rem;
      background: #fff;
      padding: 0.8rem;
      border-radius: 1rem;
      {% comment %} overflow: auto; {% endcomment %}
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);

      display: grid;
      gap: 1rem;
      grid-template-columns: 2fr 2fr 1.5fr;
      grid-template-rows: 0.1fr 2fr 1fr;
      grid-template-areas:
          "quiz-title quiz-title quiz-title"
          "question-section question-section questions-nav-section"
          "explanation-section explanation-section questions-nav-section";
  }

  .quiz-title {
      grid-area: quiz-title;
      font-weight: 800;
      font-size: 1rem;
      text-align: center;
      margin-bottom: 1rem;
  }

  .question-section {
      grid-area: question-section
  }

  .question {
      padding: 0.5rem;
      border: 2px solid #799efe;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
  }

  .question .question-text {
      margin-bottom: 0.5rem;
  }

  .question .question-num {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 1rem;
  }

  .answer-item {
      padding: 1rem 0;
      display: block;
      box-shadow: 0 7px 7px rgba(0, 0, 0, 0.1);
      border-radius: 0.5rem;
      margin-bottom: 0.5rem;
      cursor: pointer;
  }

  .answer-item.checked {
      background: #4563c8;
      color: #fff;
  }

  .answer-item.wrong {
      background: #4563c8 ;
      color: #fff;
  }

  .answer-item span {
      display: block;
      padding-left: 2rem;
      overflow-wrap: break-word;
  }

  .answer-item:hover,
  .answer-item:active {
      background: #aabdff;
      color: #fff;
  }

  .answer-item input[type="radio"] {
      display: none;
  }

  .action1 {
      margin-top: 1rem;
      margin-bottom: 1rem;
      text-align: center;
  }

  .btn {
      background: inherit;
      border: 0;
      border-radius: 0.5rem;
      box-shadow: 0 7px 7px rgba(0, 0, 0, 0.1);
      padding: 0.5rem 1rem;
      margin-right: 1.5rem;
      font-weight: 700;
      cursor: pointer;
  }

  .btn:hover,
  .btn:active {
      background: #aabdff;
      color: #fff;
  }

  .explanation-section {
      grid-area: explanation-section;
      padding: 0.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 7px 7px rgba(0, 0, 0, 0.1);
  }

  .explanation-section .section-title {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 1rem;
  }

  .explanation-section .explanation-text {
      margin-right: 1rem;
      margin-left: 1rem;
      margin-bottom: 1.5rem;
  }

  .questions-nav-section {
      grid-area: questions-nav-section;
      padding: 1rem;
      box-shadow: 0 7px 7px rgba(0, 0, 0, 0.1);
      border-radius: 0.5rem;
  }

  .questions-nav-section .question-nums-list {
      /* max-width: 100%; */
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-auto-rows: minmax(0, 1fr);
      gap: 10px;
      list-style: none;
      padding: 0;
      margin: 0;
  }

  .questions-nav-section .question-nums-list a {
      text-decoration: none;
      color: inherit;
      padding: 0.5rem;
      background: #c4c4c4;
      border-radius: 50%;
      display: inline-block;
      width: 2.5rem;
      height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #fff;
      cursor: pointer;
  }

  .questions-nav-section .question-nums-list a:hover {
      filter: brightness(0.9)
  }

  .questions-nav-section .question-nums-list a.active {
      background: #007bff;
      color: #fff;
  }

  .questions-nav-section .question-nums-list a.selected {
    background: #4caf50;
  }

  .questions-nav-section .question-nums-list a.not-selected {
    background: #ff6b6b;
  }


  .question-context {
      margin-bottom: 2rem;
      display: flex;
      justify-content: space-between;
  }

  .question-context a {
      font-weight: 700;
      font-size: 0.9rem;
      text-decoration: none;
      color: inherit;
  }

  .question-context a:hover {
      color: #aabdff;
  }

  .d-flex {
      display: flex;
      justify-content: center;
      width: 100%;
  }

  @media(max-width: 50rem) {
      .container {
          grid-template-rows: 0.1fr 1fr 1fr;
          border-radius: 0;
          position: static;
          height: 100vh;
          width: 100%;
          top: 0%;
          left: 0%;
          transform: translate(0%, 0%);

      }
  }

  @media (max-width: 38rem) {
      .container {function updateAnswerStyles(index) {
          var answerItems = questions[index].querySelectorAll('.answer-item');
          var isSelected = selectedOptions[index] !== null;

          answerItems.forEach(function (item, i) {
            item.classList.remove('checked', 'not-selected');

            if (isSelected && selectedOptions[index] === i + 1) {
              item.classList.add('checked');
            } else {
              item.classList.add('not-selected');
            }
          });
        }
          grid-template-rows: 0.1fr 1fr 1fr;
          border-radius: 0;
          position: static;
          height: 100vh;
          width: 100%;
          top: 0%;
          left: 0%;
          transform: translate(0%, 0%);


          grid-template-columns: 1fr;
          grid-template-rows: 0.1fr 1fr 1fr auto;
          grid-template-areas:
              "quiz-title"
              "questions-nav-section"
              "question-section"
              "explanation-section";
      }
  }
  form {
      margin: 0; /* Remove default margin */
      padding: 0; /* Remove default padding */
      border: none; /* Remove default border */
      display: contents;
  }

  #sub{
      background-color: blue;
  }
  .sub1{
      position: fixed;
      bottom: 3%;
      width: 25%;
      color: white;
      text-align: center;
  }
</style>
<main>
  <div class="container">
    <h1 class="quiz-title">Quiz Title</h1>
    <form id="quizForm" method="post">
      {% csrf_token %}
      <section class="question-section">
        {% for q in questions %}
        <div class="question_set">
          <div class="question">
            <h2 class="question-num">Question {{forloop.counter}}</h2>
            <p class="question-text">{{q.question}}</p>
          </div>
          <div class="answer">
            <label class="answer-item">
              <input
                type="radio"
                name="{{q.id}}"
                onchange="toggleParentClass(this)"
                value="{{q.option1}}"
                id=""
              />
              <span>{{q.option1}}</span>
            </label>
            <label class="answer-item">
              <input
                type="radio"
                name="{{q.id}}"
                onchange="toggleParentClass(this)"
                value="{{q.option2}}"
                id=""
              />
              <span>{{q.option2}}</span>
            </label>
            <label class="answer-item">
              <input
                type="radio"
                name="{{q.id}}"
                onchange="toggleParentClass(this)"
                value="{{q.option3}}"
                id=""
              />
              <span>{{q.option3}}</span>
            </label>
            <label class="answer-item">
              <input
                type="radio"
                name="{{q.id}}"
                onchange="toggleParentClass(this)"
                value="{{q.option4}}"
                id=""
              />
              <span>{{q.option4}}</span>
            </label>
          </div>
        </div>
        {% endfor %}
        <div class="action1">
          <button
            type="button"
            class="btn"
            id="btn-prev"
            onclick="prev_question()"
          >
            Prev
          </button>
          <button
            type="button"
            class="btn"
            id="btn-next"
            onclick="next_question()"
          >
            Next
          </button>
        </div>
      </section>
    </form>
    <section class="questions-nav-section">
      <p class="question-context">
        <a href="#"
          ><span class="question-num1">1/{{questions|length}}</span></a
        >
        <a href="#"><span class="question-help">Need Help?</span></a>
      </p>
      <div class="d-flex">
        <ul class="question-nums-list">
          {% for i in questions %}
          <li class="no_count">
            <a
              id="{{i.id}}"
              class=""
              onclick="goto_question({{forloop.counter}})"
              >{{forloop.counter}}</a
            >
          </li>
          {% endfor %}
        </ul>
      </div>

      <div class="sub1">
        <input
          type="submit"
          id="sub"
          class="btn btn-primary"
          onclick="submitForm()"
        />
      </div>
    </section>
  </div>
</main>

<script>
    var questions = document.querySelectorAll(".question_set");
    var currentQuestionIndex = 0;
    var selectedOptions = new Array(questions.length).fill(null);
    
    document.addEventListener("DOMContentLoaded", function () {
      function showQuestion(index) {
        questions.forEach(function (question, i) {
          if (i === index) {
            question.style.display = "block";
            question.classList.add("active-question");
          } else {
            question.style.display = "none";
            question.classList.remove("active-question");
          }
        });
      }
    
      function updateNavLinks(index) {
        var navLinks = document.querySelectorAll(".question-nums-list a");
        var questionNumSpan = document.querySelector(".question-num1");
    
        navLinks.forEach(function (link, i) {
          link.classList.toggle("active", i === index);
        });
        questionNumSpan.textContent = index + 1 + "/" + questions.length;
      }
    
      function updateSelectedOptions() {
        let currentQuestion = questions[currentQuestionIndex];
        let navButtons = document.querySelectorAll(".question-nums-list a");
        let currentNavButton = navButtons[currentQuestionIndex];
    
        selectedOptions[currentQuestionIndex] = getSelectedOptionValue();
    
        if (currentQuestion.classList.contains("active-question")) {
          currentNavButton.classList.add("active");
        }
    
        if (selectedOptions[currentQuestionIndex] !== null) {
          currentNavButton.classList.add("selected");
          currentNavButton.classList.remove("not-selected");
        } else {
          currentNavButton.classList.remove("selected");
          currentNavButton.classList.add("not-selected");
        }
      }
    
      window.goto_question = function (index) {
        currentQuestionIndex = index - 1;
        showQuestion(currentQuestionIndex);
        updateNavLinks(currentQuestionIndex);
      };
    
      window.next_question = function () {
        if (currentQuestionIndex < questions.length - 1) {
          updateSelectedOptions();
          currentQuestionIndex++;
          showQuestion(currentQuestionIndex);
          updateNavLinks(currentQuestionIndex);
        }
      };
    
      window.prev_question = function () {
        if (currentQuestionIndex > 0) {
          updateSelectedOptions();
          currentQuestionIndex--;
          showQuestion(currentQuestionIndex);
          updateNavLinks(currentQuestionIndex);
        }
      };
    
      window.toggleParentClass = function (radioInput) {
        selectedOptions[currentQuestionIndex] = parseInt(radioInput.value);
        updateSelectedOptions();
      };
    
      function getSelectedOptionValue() {
        var radioButtons = document.querySelectorAll('.question_set.active-question .answer-item input[type="radio"]:checked');
        return radioButtons.length > 0 ? parseInt(radioButtons[0].value) : null;
      }
    
      showQuestion(currentQuestionIndex);
      updateNavLinks(currentQuestionIndex);

      var radioButtons = document.querySelectorAll('.answer-item input[type="radio"]');

      radioButtons.forEach(function (radio) {
        radio.addEventListener("change", function () {
          document.querySelectorAll(".question_set.active-question .answer-item").forEach(function (item) {
            item.classList.remove("checked");
          });
          if (radio.checked) {
            radio.closest(".answer-item").classList.add("checked");
          }
        });
      });
    });
    
    function submitForm() {
      document.getElementById('quizForm').submit();
    }
    
</script>

{% comment %}
<script>
    
    document.addEventListener('DOMContentLoaded', function () {
        var questions = document.querySelectorAll('.question_set');
        var currentQuestionIndex = 0;
        
        // Function to show a specific question
        function showQuestion(index) {
            questions.forEach(function (question, i) {
                question.style.display = i === index ? 'block' : 'none';
            });
        }   
        
        // Show the first question on load
        showQuestion(currentQuestionIndex);

        // Previous Question
        document.getElementById('btn-prev').addEventListener('click', function () {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion(currentQuestionIndex);
                document.getElementsByClassName('question-num1')[0].textContent = currentQuestionIndex+1+"/"+ {{questions|length}}
            }
        });

        
        
        // Next Question
        document.getElementById('btn-next').addEventListener('click', function () {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
                document.getElementsByClassName('question-num1')[0].textContent = currentQuestionIndex+1+"/"+ {{questions|length}};
                p = document.getElementsByClassName('question_set')[currentQuestionIndex-1].getElementsByClassName('answer')[0].getElementsByClassName('answer-item checked')[0];
                if (p){
                    document.getElementsByClassName('no_count')[currentQuestionIndex-1].querySelector('a').className = 'done';
                }
                else{
                    document.getElementsByClassName('no_count')[currentQuestionIndex-1].querySelector('a').className = 'active'
                }
            }
        });
        questions.forEach(function (question) {
            var questionId = question.querySelector('input[type="radio"]').getAttribute('name');
            var radios = question.querySelectorAll('input[type="radio"]');
            radios.forEach(function (radio) {
                radio.setAttribute('name', questionId);
            });
        }); 
    });


 function toggleParentClass(radio) {
    var parent = radio.parentNode;
    console.log(parent);    
    // Remove 'checked' class from all answer-items
    var answerItems = document.querySelectorAll('.answer-item');
    
    for (var i = 0; i < answerItems.length; i++) {
        if (answerItems[i] !== parent) { 
          answerItems[i].classList.remove('checked');
            }
      } 

    if (radio.checked) {
        parent.classList.add('checked');
    }
    else {
        parent.classList.remove('checked');
    }
} 

var questions = document.querySelectorAll('.question_set');
    var currentQuestionIndex = 0;
    
    // Function to show a specific question
    function showQuestion(index) {
        questions.forEach(function (question, i) {
            question.style.display = i === index-1 ? 'block' : 'none';
        });
    }   
    function goto_question(index){
        showQuestion(index);
    }
    function submitForm() {
        document.getElementById('quizForm').submit();
    }
    
</script>
{% endcomment %}
